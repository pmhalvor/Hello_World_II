Low-mass Main Sequence
======================

Project directory for a model of zero-age, fully convective, low-mass main sequence stars.

Contents
--------

1. `README.md`: this file
2. `adiabat.py`: Computes the density and temperature along an adiabat
  given the central pressure, density, and temperature,
  as well as a the respective pressure
3. `astro_const.py`: Series of useful constants which are used trough out the code
4. `eos.py`: Calculates the equation of state for various masses, temperatures, and pressures
5. `nuc_rate.py`:Computes the nuclear reaction rate for various temperatures and     pressure
6. `ode.py`: Numerical systems by which we integrate over our system of ODEs.
7. `rad_finder.py`: Equates surface luminosity to nuclear luminosity to find the ZAMS radius
8. `run_test.py`: Runs a test of the main codes
9. `structure.py`: Systems of stellar structure for which we integrate over.
10. `Teff.py`: Calculates the effective temperature for a given fraction of mass.
11. `exercise9.py`: Calculates the Luminosity and Central Temperature vs the effective temperature for a fully convective star of 0.1 to 0.3 Solar masses.
12. `exercise10.py`: Plots the central temperature and Luminosity for a 0.3 Solar mass start
13. `Plots Folder`: Contains all the plots that are generated by the exercise Plots

Report/closeout
---------------

# Verify our scaling constants for central pressure and density

In order to verify that our constants that scale our central pressure and density, we ran our code from project 2 with our K_e multiplied by 0.5 and 2. Our values for alpha and beta in the tables did not change with a larger or smaller K_e. Screenshots of these tables are included in the repository as 0.5K.PNG and 2K.PNG

# Mean molecular weight
<html>
<img src="https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/pics/mu.PNG?raw=true" width= 200px>
</html>

The mean molecular weight is the ratio of the total weight of the star versus the total of free floating particles in the star. Assuming all the atoms are fully ionized, the number of free floating electrons will be equal to the respective number of protons in each element. Our method takes in the different fractions of hydrogen, helium and nitrogen our low mass star consists of as arguments. Inside the method, we define the nucleus and proton counts for each element. We return the inverse of the sum of the different proportions.

# Density and temperatures along an adiabat
With our scaling coefficients from part 1., we can get estimates for our central pressure and density using the virial relations.
<img src="https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/pics/central_press_and_den.PNG?raw=true" width=400px>

Central temperature was also estimated from virial relation and the help of the values of central pressure and density.

<img src="https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/pics/central_temp.PNG?raw=true" width=200px>

The pressure, density and temperature along an adiabat are given by the following formulas.

<img src="https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/pics/adiabat.PNG?raw=true" width=600px>

From here, we were able to build an adiabat method that returns the density and temperature corresponding to a pressure, given as an argument. We then compared our results for density and temperature to our given pressure with the ideal gas equation. Our average error for 100 different pressures between 10^-3*P_c and P_c was 7.5e-17, with a max error of 2.963e-16. These values are well below machine percision, and can therefore be disregarded.


# Nuclear Reaction Rate
To calculate the nuclear reaction rate, we used this equation to create a function in `nuc_rate.py`   
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/nuc_rate_equation.JPG)  
This function takes in Temperature, Density, and the fraction of Hydrogen to compute the reaction rate for the current mass step. We then did a hand calculation for a few different values of temperature and density to verify that the function was working accurately.

# Integration Routine
Our integration function, found in `structure.py`, takes in a total Mass, Radius, and mu value. From this the central values for Temperature, Pressure, and Density can be found from the virial scalings above. Once these central values are found we can integrate over mass until we get to the outside of the star. While integrating we need to know the density and temperature at each mass step. This can luckily be found by using our adiabat module from above.  
Using this routine, we were able to find return the Pressure and Luminosity throughout a low mass star of a given mass and radius.  

## Convergence
We had three parameters (xi, eta, delta_m) that we had control over in the integration routine. To start with we chose similar values to our previous white dwarf project. Then we adjusted the parameters and looked at the error between the mass and radius we put in and the total mass and radius that our routine outputted. We found that xi had the largest impact and settled on a value of 0.01 which gave us an error of less than 0.005. For eta we settled on 1e-14 and for delta m we used a value of 1e-9.

# Our method for interpolation of effective temperatures
Table 1 gives us the theoretical effective temperatures for four masses between 0.1 solar mass and 0.3 solar mass. Our method Teff uses these values to get an estimate of the effective temperature for a mass between these values wiht the help of numpy's interpolation method. These estimates are not exact, but correlate pretty well with the data from the Paxton paper linked in the exercise text.

# Finding Correct Radius
Since our integration routine requires the stars Mass and Radius, we cannot use it to find the radius of a star given its mass. Instead we can compare the nuclear Luminosity that we calculate from our integration and compare that to what the surface Luminosity should be for a star of that radius. To do this we need to know the effective Temperature for the star given its Mass. This is why we created the interpolation function above.  
So, we create an error function that takes in a total Mass and returns Lnuc - Lsurface where Lnuc is given by our integration routine and Lsurface is given by  
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/pics/Lsurface_equation.JPG)  
We then used a brentq method and a range of radii values to calculate the Zero Age Main Sequence (ZAMS) radius for a star of the given mass.

# Results
## H-R Diagram
Using our integration method along with finding the ZAMS Radius, we were able to create an H-R Diagram plotting Luminosity vs Effective Temperature for Low mass stars (0.1 to 0.3 Solar Mass).  
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/LumVsTeff.png)  
Comparing to the results from Paxton et al. (2011), we appear to have some differing values for our Luminosity although our values to fall in a similar range. The shape of our result also matches what their paper has (the 0.2 to 0.3 range has a much steeper slope and is more compressed than the range from 0.1 to 0.2).  

## Central Density and Temperature
In addition to an H-R Diagram, we plotted how central Temperature and Density changes with total stellar mass. We used the same low mass range of 0.1 to 0.3 Solar Mass.
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/cDensityVsTemp.png)
Comparing again to the results in the Paxton paper, we appear to have some slightly differing values although it is on the same range of values for central Temperature and Density. In addition it appears to have the same linear shape that is found in the paper.

# 0.3 Solar Mass Star
Taking a more in depth look at a 0.3 stellar mass star we found that it had a radius of about one third of a Solar Radius. Below you can see how Luminosity and Temperature changes throughout the star either by radius or by total mass enclosed.  
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/mass0.3_plots.png)  
The red line on these graphs show the point where the luminosity is 90% of maximum value. The radius when this occurs is at 0.13 Solar Radii which is about 39.1% of the total Radius of the star. 26.5% of the total Mass was enclosed when luminosity was at 90%.

# What if the Weak Interaction Were Not So Weak
With the code we had, we decided what our stars would look like if we increased the weak interaction by 5 orders of magnitude. This meant that our nuclear reaction rate would also increase by 10^5. Making this addition to our code we found the following results for the same plots shown above.  
![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/inc_nuc_rate_LumVsTeff.png)  
This new H-R Diagram shows that the Stellar Luminosity would increase by about 10^1.5 or 30 times. This would mean a lot of things, namely the life spans for stars would decrease due to greater energy loss and if this had a similar effect to the sun, we would likely be burned to crisp here on earth.  

![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/inc_nuc_rate_cDensityVsTemp.png)  

In the second plot, you can see that the the central Temperature and Density values decrease by 5 times and 100 times respectively. This is likely due to the fact that nuclear reactions can begin at lower Temperatures and Densities than before. This has a great impact on stellar structure which you can see in the next set of plots.  

![](https://github.com/MSU-AST304-FS2018/gcp3-main-sequence-armadillos/blob/master/plots/inc_nuc_rate_mass0.3_plots.png)  

In the final set of plots we can see that the increased strength of the weak interaction causes the ZAMS Radius of the Star to increase by roughly 6 times. This explains why the central Density and Temperature decreased in the previous plot. However, while comparing these plots to the ones with the true weak force strength, the general shapes and forms are all fairly identical with only the scalings changing.  

# References
Bill Paxton, Lars Bildsten, Aaron Dotter, Falk Herwig, Pierre Lesaffre, and Frank Timmes.  Modules for experiments in stellar astrophysics (MESA). ApJS, 192:3, January 2011.

Resources
---------

Coding standards and the grading rubric are posted on D2L.
